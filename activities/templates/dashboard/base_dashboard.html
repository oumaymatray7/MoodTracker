<!DOCTYPE html>
{% load static %}
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>MoodTracker | Tableau de bord</title>

    <!-- Meta Tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="MoodTracker | Tableau de bord" />
    <meta name="author" content="MoodTracker Team" />
    <meta name="description" content="Plateforme de suivi de bien-être personnalisée." />
    <meta name="keywords" content="bien-être, dashboard, mood, santé mentale, suivi" />

    <!-- Google Fonts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css"
      integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q="
      crossorigin="anonymous"
    />

    <!-- OverlayScrollbars -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css"
      integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg="
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI="
      crossorigin="anonymous"
    />

    <!-- AdminLTE CSS -->
    <link rel="stylesheet" href="{% static 'adminlte/dist/css/adminlte.css' %}" />

    <!-- ApexCharts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css"
      integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0="
      crossorigin="anonymous"
    />
    <style>
      /* Thème Clair */
      .light-mode {
        background-color: #ffffff;
        color: #212529;
      }
      
      /* Thème Sombre */
      .dark-mode {
        background-color: #343a40;
        color: #f8f9fa;
      }
      
      /* Thème Bleu Doux */
      .blue-soft-mode {
        background-color: #e7f1ff;
        color: #0d6efd;
      }
      
      /* Animation douce */
      .container, .card, .card-body {
        transition: background-color 0.5s ease, color 0.5s ease;
      }
      </style>
      
  </head>
  
  <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <!--begin::App Wrapper-->
    <div class="app-wrapper">
      <!--begin::Header-->
      
    <!--end::Header-->

    <!--begin::Sidebar-->
    <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
      <!--begin::Sidebar Brand-->
      <div class="sidebar-brand">
        <a href="{% url 'mes_activites' %}" class="brand-link">
          <img
            src="{% static 'adminlte/dist/assets/img/AdminLTELogo.png' %}"
            alt="MoodTracker Logo"
            class="brand-image opacity-75 shadow"
          />
          <span class="brand-text fw-light">MoodTracker</span>
        </a>
      </div>
      <!--end::Sidebar Brand-->

      <!--begin::Sidebar Wrapper-->
      <div class="sidebar-wrapper">
        <nav class="mt-2">
          <!--begin::Sidebar Menu-->
          <ul class="nav sidebar-menu flex-column"
          data-lte-toggle="treeview"
          role="menu"
          data-accordion="false">
      
            <li class="nav-item menu-open">
              <a href="{% url 'mes_activites' %}" class="nav-link active">
                <i class="nav-icon bi bi-speedometer"></i>
                <p>
                  Tableau de bord
                  <i class="nav-arrow bi bi-chevron-right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="{% url 'mes_activites' %}" class="nav-link active">
                    <i class="nav-icon bi bi-circle"></i>
                    <p>Mes Activités</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="{% url 'ajouter_activite' %}" class="nav-link">
                    <i class="nav-icon bi bi-plus-circle"></i>
                    <p>Ajouter Activité</p>
                  </a>
                  
                </li>
                
                
                
                <li class="nav-item">
                  <a href="{% url 'statistiques' %}" class="nav-link">

                    <i class="nav-icon bi bi-circle"></i>
                    <p>Statistiques</p>
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item">
              <a href="{% url 'themes' %}" class="nav-link">
                <i class="nav-icon bi bi-palette"></i>
                <p>Thèmes</p>
              </a>
            </li>

            

            <li class="nav-header">EXEMPLES</li>

            {% if user.is_authenticated %}
            <li class="nav-item has-treeview" id="auth-menu">
              <a href="#" class="nav-link">
                <i class="nav-icon bi bi-box-arrow-in-right"></i>
                <p>
                  Authentification
                  <i class="right bi bi-chevron-down"></i>
                </p>
              </a>
            
              <ul class="nav nav-treeview ms-3" style="display: none;">  <!-- On cache par défaut -->
                <li class="nav-item">
                  <a href="{% url 'profile' %}" class="nav-link">
                    <i class="bi bi-person-circle nav-icon"></i>
                    <p>Mon compte</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="{% url 'logout' %}" class="nav-link">
                    <i class="bi bi-box-arrow-right nav-icon"></i>
                    <p>Se déconnecter</p>
                  </a>
                </li>
              </ul>
            </li>
            {% endif %}
            
            
            <li class="nav-header">ANALYSES & RAPPORTS</li>

            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="nav-icon bi bi-clock-history"></i>
                <p>Historique</p>
              </a>
            </li>
            
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="nav-icon bi bi-bullseye"></i>
                <p>Mes Objectifs</p>
              </a>
            </li>
            
            <li class="nav-item has-treeview" id="rapport-menu">
              <a href="#" class="nav-link">
                <i class="nav-icon bi bi-graph-up"></i>
                <p>
                  Rapports détaillés
                  <i class="right bi bi-chevron-down"></i>
                </p>
              </a>
            
              <ul class="nav nav-treeview ms-3" style="display: none;">
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="nav-icon bi bi-calendar-event"></i>
                    <p>Rapport Mensuel</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="nav-icon bi bi-calendar-range"></i>
                    <p>Rapport Annuel</p>
                  </a>
                </li>
              </ul>
            </li>
            
                  </ul>
                  <!--end::Sidebar Menu-->
                </nav>
              </div>
              <!--end::Sidebar Wrapper-->
            </aside>
            <!--end::Sidebar-->
      
            <!--begin::App Main-->
            <main class="app-main">
              <div class="container mt-4">
                {% block content %}
                {% endblock %}
              </div>
            </main>
            
            
              
              <!--begin::App Content Header-->
              <div class="app-content-header">
                <!--begin::Container-->
                <div class="container-fluid">
                  <!--begin::Row-->
                  <div class="row">
                    <div class="col-sm-6"><h3 class="mb-0">Tableau de bord - Activités</h3></div>
                    <div class="col-sm-6">
                      <ol class="breadcrumb float-sm-end">
                        <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Accueil</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Activités</li>
                      </ol>
                    </div>
                  </div>
                  <!--end::Row-->
                </div>
                <!--end::Container-->
              </div>
      
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title">Récapitulatif mensuel - Activités de bien-être</h5>
                  <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-lte-toggle="card-collapse">
                      <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
                      <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
                    </button>
                    <div class="btn-group">
                      <button
                        type="button"
                        class="btn btn-tool dropdown-toggle"
                        data-bs-toggle="dropdown"
                      >
                        <i class="bi bi-wrench"></i>
                      </button>
                      <div class="dropdown-menu dropdown-menu-end" role="menu">
                        <a href="#" class="dropdown-item">Exporter PDF</a>
                        <a href="#" class="dropdown-item">Télécharger rapport</a>
                      </div>
                    </div>
                    <button type="button" class="btn btn-tool" data-lte-toggle="card-remove">
                      <i class="bi bi-x-lg"></i>
                    </button>
                  </div>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                  <!--begin::Row-->
                  <div class="row">
                    <div class="col-md-8">
                      <p class="text-center">
                        <strong>Activités enregistrées : 1 Avril 2025 - 25 Avril 2025</strong>
                      </p>
                      <div id="sales-chart"></div>
                    </div>
                    <!-- /.col -->
                    <div class="col-md-4">
                      <p class="text-center"><strong>Objectifs atteints</strong></p>
                      <div class="progress-group">
                        Méditation quotidienne
                        <span class="float-end"><b>20</b>/30 jours</span>
                        <div class="progress progress-sm">
                          <div class="progress-bar text-bg-primary" style="width: 66%"></div>
                        </div>
                      </div>
                      <div class="progress-group">
                        Activité physique
                        <span class="float-end"><b>12</b>/20 séances</span>
                        <div class="progress progress-sm">
                          <div class="progress-bar text-bg-success" style="width: 60%"></div>
                        </div>
                      </div>
                      <div class="progress-group">
                        Journaling / Notes d’humeur
                        <span class="float-end"><b>15</b>/25 jours</span>
                        <div class="progress progress-sm">
                          <div class="progress-bar text-bg-warning" style="width: 60%"></div>
                        </div>
                      </div>
                      <div class="progress-group">
                        Sommeil réparateur (8h+)
                        <span class="float-end"><b>10</b>/30 nuits</span>
                        <div class="progress progress-sm">
                          <div class="progress-bar text-bg-danger" style="width: 33%"></div>
                        </div>
                      </div>
                    </div>
                    <!-- /.col -->
                  </div>
                  <!--end::Row-->
                </div>
                <!-- ./card-body -->
                <div class="card-footer">
                  <!--begin::Row-->
                  <div class="row">
                    <div class="col-md-3 col-6">
                      <div class="text-center border-end">
                        <span class="text-success">
                          <i class="bi bi-caret-up-fill"></i> +15%
                        </span>
                        <h5 class="fw-bold mb-0">120 activités</h5>
                        <span class="text-uppercase">TOTAL DU MOIS</span>
                      </div>
                    </div>
                    <div class="col-md-3 col-6">
                      <div class="text-center border-end">
                        <span class="text-info"> <i class="bi bi-caret-left-fill"></i> Stable </span>
                        <h5 class="fw-bold mb-0">7.2 / 10</h5>
                        <span class="text-uppercase">HUMEUR MOYENNE</span>
                      </div>
                    </div>
              
                <!-- Statistiques d'humeur et d'activité -->
<div class="row">
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-header bg-info text-white">
        <h5 class="card-title">Statistiques Bien-être</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 text-center border-end">
            <span class="text-success">
              <i class="bi bi-caret-up-fill"></i> +20%
            </span>
            <h5 class="fw-bold mb-0">+5.2 pts</h5>
            <span class="text-uppercase">ÉVOLUTION HUMEUR</span>
          </div>
          <div class="col-md-6 text-center">
            <span class="text-danger">
              <i class="bi bi-caret-down-fill"></i> -10%
            </span>
            <h5 class="fw-bold mb-0">3 jours</h5>
            <span class="text-uppercase">JOURS SANS ACTIVITÉ</span>
          </div>
        </div>
        <hr />
        <div class="row mt-4">
          <div class="col-md-6 text-center border-end">
            <h6>Activités ce mois</h6>
            <p class="fw-bold text-primary fs-4">{{ activites|length }}</p>
          </div>
          <div class="col-md-6 text-center">
            <h6>Temps moyen par activité</h6>
            <p class="fw-bold text-success fs-4">45 min</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Conseil du jour -->
  <div class="col-md-6">
    <div class="card mb-4 border-success">
      <div class="card-header bg-success text-white">
        <h5 class="card-title">Conseil du jour 🌿</h5>
      </div>
      <div class="card-body">
        <blockquote class="blockquote mb-3">
          <p>🧘‍♀️ Respirez profondément pendant 2 minutes pour libérer les tensions.</p>
          <footer class="blockquote-footer">Coach MoodTracker</footer>
        </blockquote>
        <p class="mb-0">
          💡 <strong>Astuce :</strong> Planifiez une activité bien-être pour ce soir. Même 10 minutes de marche ou de méditation font la différence.
        </p>
      </div>
    </div>
  </div>
</div>
<!-- VOS DERNIÈRES ACTIVITÉS -->
<div class="card">
  <div class="card-header bg-primary text-white">
    <h3 class="card-title">Vos dernières activités</h3>
    <div class="card-tools">
      <span class="badge text-bg-light">Mis à jour aujourd’hui</span>
      <button
        type="button"
        class="btn btn-tool"
        data-lte-toggle="card-collapse"
      >
        <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
        <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
      </button>
      <button
        type="button"
        class="btn btn-tool"
        data-lte-toggle="card-remove"
      >
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
  <!-- /.card-header -->
  <div class="card-body p-2">
    {% if activites %}
      <ul class="list-group list-group-flush">
        {% for activite in activites|slice:":6" %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <h6 class="mb-1">{{ activite.nom }}</h6>
              <small class="text-muted">{{ activite.date|date:"d M Y" }} à {{ activite.date|time:"H:i" }}</small>
            </div>
            <span class="badge bg-success rounded-pill">+ {{ activite.points }} pts</span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <div class="text-center py-4">
        <p class="text-muted">Aucune activité enregistrée pour le moment.</p>
        <a href="{% url 'ajouter_activite' %}" class="btn btn-outline-primary btn-sm">Ajouter une activité</a>
      </div>
    {% endif %}
  </div>
  <!-- /.card-body -->
  <div class="card-footer text-center">
    <a href="{% url 'mes_activites' %}" class="text-decoration-none">
      📋 Voir toutes mes activités
    </a>
  </div>
  <!-- /.card-footer -->
</div>
<!-- /.card -->

                  <!-- HISTORIQUE DES ACTIVITÉS -->
<div class="card">
  <div class="card-header bg-success text-white">
    <h3 class="card-title">Historique des Activités Récentes</h3>
    <div class="card-tools">
      <button type="button" class="btn btn-tool" data-lte-toggle="card-collapse">
        <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
        <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
      </button>
      <button type="button" class="btn btn-tool" data-lte-toggle="card-remove">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
  <!-- /.card-header -->
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover m-0">
        <thead>
          <tr>
            <th>Date</th>
            <th>Activité</th>
            <th>Humeur</th>
            <th>Score Bien-être</th>
          </tr>
        </thead>
        <tbody>
          {% for activite in activites|slice:":7" %}
          <tr>
            <td>{{ activite.date|date:"d M Y H:i" }}</td>
            <td>{{ activite.nom }}</td>
            <td>
              {% if activite.humeur == "Heureux" %}
                <span class="badge text-bg-success">😀 Heureux</span>
              {% elif activite.humeur == "Triste" %}
                <span class="badge text-bg-danger">😢 Triste</span>
              {% elif activite.humeur == "Fatigué" %}
                <span class="badge text-bg-warning">😴 Fatigué</span>
              {% else %}
                <span class="badge text-bg-info">{{ activite.humeur }}</span>
              {% endif %}
            </td>
            <td>
              <div class="progress progress-sm">
                <div class="progress-bar bg-success" style="width: {{ activite.points }}%">
                  {{ activite.points }}%
                </div>
              </div>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">Aucune activité enregistrée.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <!-- /.table-responsive -->
  </div>
  <!-- /.card-body -->
  <div class="card-footer text-center">
    <a href="{% url 'mes_activites' %}" class="btn btn-sm btn-outline-success">
      📊 Voir l’historique complet
    </a>
  </div>
  <!-- /.card-footer -->
</div>
<!-- /.card -->
<!-- ACTIVITÉS RÉCENTES -->
<div class="card">
  <div class="card-header bg-primary text-white">
    <h3 class="card-title">Activités récemment ajoutées</h3>
    <div class="card-tools">
      <button type="button" class="btn btn-tool" data-lte-toggle="card-collapse">
        <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
        <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
      </button>
      <button type="button" class="btn btn-tool" data-lte-toggle="card-remove">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
  <!-- /.card-header -->
  <div class="card-body p-0">
    <div class="px-2">
      {% for activite in activites|slice:":4" %}
      <div class="d-flex border-top py-2 px-1 align-items-center">
        <div class="col-2">
          <img
            src="{% static 'adminlte/dist/assets/img/default-150x150.png' %}"
            alt="Activité"
            class="img-size-50 rounded-circle"
          />
        </div>
        <div class="col-10">
          <a href="{% url 'mes_activites' %}" class="fw-bold d-block text-dark">
            {{ activite.nom }}
            <span class="badge float-end 
              {% if activite.humeur == 'Heureux' %}
                text-bg-success
              {% elif activite.humeur == 'Triste' %}
                text-bg-danger
              {% else %}
                text-bg-info
              {% endif %}
            ">
              {{ activite.humeur }}
            </span>
          </a>
          <div class="text-muted small">{{ activite.date|date:"d M Y, H:i" }}</div>
        </div>
      </div>
      {% empty %}
      <p class="text-center text-muted m-3">Aucune activité pour le moment.</p>
      {% endfor %}
    </div>
  </div>
  <!-- /.card-body -->
  <div class="card-footer text-center">
    <a href="{% url 'mes_activites' %}" class="btn btn-sm btn-outline-primary">
      📖 Voir toutes les activités
    </a>
  </div>
  <!-- /.card-footer -->
</div>
<!-- /.card -->

  <!-- Section: Recently Added Products -> Dernières Activités de Bien-Être -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">Dernières Activités</h3>
    <div class="card-tools">
      <span class="badge text-bg-primary">{{ activites|length }} Activité(s)</span>
      <button type="button" class="btn btn-tool" data-lte-toggle="card-collapse">
        <i data-lte-icon="expand" class="bi bi-plus-lg"></i>
        <i data-lte-icon="collapse" class="bi bi-dash-lg"></i>
      </button>
      <button type="button" class="btn btn-tool" data-lte-toggle="card-remove">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
  <!-- /.card-header -->
  <div class="card-body p-0">
    <div class="px-2">
      {% if activites.exists %}
        {% for activite in activites|slice:":4" %}
          <div class="d-flex border-top py-2 px-1">
            <div class="col-2 d-flex align-items-center justify-content-center">
              <i class="bi bi-emoji-smile fs-3 text-warning"></i>
            </div>
            <div class="col-10">
              <a href="{% url 'mes_activites' %}" class="fw-bold">
                {{ activite.nom }}
                <span class="badge float-end 
                  {% if activite.humeur == 'Heureux' %}text-bg-success{% elif activite.humeur == 'Triste' %}text-bg-danger{% else %}text-bg-secondary{% endif %}">
                  {{ activite.humeur }}
                </span>
              </a>
              <div class="text-truncate">
                Enregistré le {{ activite.date_creation|date:"d M Y H:i" }}
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="alert alert-warning m-3">
          Aucune activité récente trouvée.
        </div>
      {% endif %}
    </div>
  </div>
  <!-- /.card-body -->
  <div class="card-footer text-center">
    <a href="{% url 'mes_activites' %}" class="uppercase"> Voir toutes les activités </a>
  </div>
  <!-- /.card-footer -->
</div>
<!-- /.card -->
 <script>
document.addEventListener('DOMContentLoaded', function() {
  const authMenu = document.querySelector('#auth-menu > a');
  const submenu = document.querySelector('#auth-menu ul');

  authMenu.addEventListener('click', function(e) {
    e.preventDefault(); // empêcher que la page saute en haut
    if (submenu.style.display === 'none') {
      submenu.style.display = 'block';
    } else {
      submenu.style.display = 'none';
    }
  });
});
</script>
